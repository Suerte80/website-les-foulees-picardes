{# Tailwind v4.1 form theme — Les Foulées Picardes #}

{% use 'form_div_layout.html.twig' %}

{% block form_start -%}
    {{- parent() -}}
{%- endblock %}

{# ===== LABEL ===== #}
{% block form_label -%}
    {% if label is not same as(false) -%}
        {% set label_attr = label_attr|merge({
            class: (label_attr.class|default('') ~ ' block text-sm font-semibold text-gray-800 mb-1')
            |trim
        }) %}
    {%- endif -%}
    {{- parent() -}}
{%- endblock %}

{# ===== ERRORS ===== #}
{% block form_errors -%}
    {% if errors|length > 0 %}
        <ul class="mt-2 text-sm text-red-700 space-y-1">
            {% for error in errors %}
                <li>• {{ error.message }}</li>
            {% endfor %}
        </ul>
    {% endif %}
{%- endblock %}

{# ===== HELP ===== #}
{% block form_help -%}
    {% if help is not empty %}
        <p class="mt-1 text-xs text-gray-600">{{ help|raw }}</p>
    {% endif %}
{%- endblock %}

{# ===== WIDGET (inputs) ===== #}
{% block form_widget_simple -%}
    {% set type = type|default('text') %}
    {% set base = 'w-full rounded-t-sm border border-amber-700/30 bg-sand-light/90
                 px-3 py-2 text-gray-900 shadow-sm
                 focus:outline-none focus:ring-2 focus:ring-accent-500 focus:border-accent-500
                 placeholder:text-gray-400' %}
    {% set class = (attr.class|default('') ~ ' ' ~ base)|trim %}
    {% set attr = attr|merge({class: class}) %}
    {{- parent() -}}
{%- endblock %}

{# ===== TEXTAREA ===== #}
{% block textarea_widget -%}
    {% set class = (attr.class|default('') ~ ' w-full rounded-t-xl border border-amber-700/30 bg-sand-light/90
                   px-3 py-2 text-gray-900 shadow-sm min-h-28
                   focus:outline-none focus:ring-2 focus:ring-accent-500 focus:border-accent-500
                   placeholder:text-gray-400')|trim %}
    {% set attr = attr|merge({class: class}) %}
    {{- parent() -}}
{%- endblock %}

{# ===== CHOICE (select) ===== #}
{% block choice_widget_collapsed -%}
    {% set class = (attr.class|default('') ~ ' w-full rounded-xl border border-amber-700/30 bg-sand-light/90
                   px-3 py-2 text-gray-900 shadow-sm
                   focus:outline-none focus:ring-2 focus:ring-accent-500 focus:border-accent-500')|trim %}
    {% set attr = attr|merge({class: class}) %}
    {{- parent() -}}
{%- endblock %}

{# ===== CHECKBOX / RADIO inline ===== #}
{% block checkbox_widget -%}
    {% set class = (attr.class|default('') ~ ' size-4 rounded border-amber-700/40 text-accent-600
                   focus:ring-accent-500')|trim %}
    {% set attr = attr|merge({class: class}) %}
    {{- parent() -}}
{%- endblock %}

{% block radio_widget -%}
    {% set class = (attr.class|default('') ~ ' size-4 border-amber-700/40 text-accent-600
                   focus:ring-accent-500')|trim %}
    {% set attr = attr|merge({class: class}) %}
    {{- parent() -}}
{%- endblock %}

{# ===== CHOICE EXPANDED (radios en “carte”) ===== #}
{% block choice_widget_expanded -%}
    <div class="space-y-2">
        {% for child in form %}
            <label class="flex items-center gap-3 rounded-xl border border-amber-700/30 bg-sand-light/90 px-3 py-2 shadow-sm cursor-pointer">
                {{ form_widget(child) }}
                <span class="text-gray-900 text-sm">{{ child.vars.label|trans({}, translation_domain) }}</span>
            </label>
        {% endfor %}
    </div>
{%- endblock %}

{# ===== ROW (label + widget + errors) ===== #}
{% block form_row -%}
    <div class="mb-4 p-2 bg-sand rounded-t-sm">
        {{- form_label(form) -}}
        {{- form_widget(form) -}}
        {{- form_help(form) -}}
        {{- form_errors(form) -}}
    </div>
{%- endblock %}

{# ===== SUBMIT BUTTON ===== #}
{% block button_widget -%}
    {% set base = 'inline-flex items-center justify-center w-full rounded-sm px-5 py-3
                 font-medium text-white bg-teal-700 shadow
                 hover:bg-teal-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-600
                 active:scale-[.99] transition' %}
    {% set class = (attr.class|default('') ~ ' ' ~ base)|trim %}
    {% set attr = attr|merge({class: class}) %}
    {{- parent() -}}
{%- endblock %}

{% block checkbox_row %}
    <div class="flex gap-2 mb-4 p-2 bg-sand rounded-t-sm">
        {{ form_widget(form) }}
        {{ form_label(form) }}
        {{ form_help(form) }}
        {{ form_errors(form) }}
    </div>
{% endblock %}
